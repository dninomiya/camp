<div class="container" *ngIf="plan$ | async as plan">
  <div class="wrap">
    <h1>{{ plan.title }}プランをはじめる</h1>

    <div class="section">
      <h2>料金</h2>
      <p>全プラン3ヶ月半額キャンペーン実施中！ 3/31まで！</p>
      <p>
        {{ plan.amount / 2 | number }}円/月
        <span class="default-price">定価: {{ plan.amount | number }}円/月</span>
      </p>

      <ul class="notice">
        <li>価格はすべて税込です</li>
        <li>3ヶ月以降は通常価格で決済がはじまります</li>
      </ul>
    </div>

    <div class="section">
      <h2>プラン内容</h2>

      <ul>
        <li *ngFor="let point of plan.points">
          {{ point }}
        </li>
      </ul>
    </div>

    <div class="section">
      <h2>決済方法</h2>
      <app-credit-card></app-credit-card>
    </div>

    <ng-container *ngIf="payment$ | async as payment">
      <button
        *ngIf="plan.id !== payment.planId; else disabled"
        mat-raised-button
        color="primary"
        (click)="signUp(plan.id, payment.customerId)"
        [disabled]="!payment.customerId || loading"
      >
        はじめる
      </button>
      <ng-template #disabled>
        <p>既に{{ plan.title }}に登録しています。</p>
      </ng-template>
    </ng-container>
  </div>
</div>
